#!/bin/bash

modulerun() {
	for folder in $(cat ${cache_home}/cachenpm.txt | dirnames); do
		pushd $folder > /dev/null

		time modulerunonce

		popd > /dev/null
	done
}

modulerunonce() {
	$NPM_INSTALL

	if [[ 0 -eq $(ls node_modules/ | grep -c '^') ]] && [ "yarn" != "$NPM_INSTALL" ]; then
		yarn
	fi
}

modulerun
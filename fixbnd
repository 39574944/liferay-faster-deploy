#!/bin/bash

fixbnd() {
	sed -i.bak 's/version: "\[[^"]*\"/version: "default"/g' $1
	python "$(dirname $0)/fixbnd.py" "$1"
	rm "$1/bnd.bnd"
	mv "$1/bnd.tmp" "$1/bnd.bnd"
}

fixbnds() {
	echo path 1

	for folder in $(git ls-files modules | grep build.gradle | xargs grep -l 'version: "\[' | xargs -I {} dirname {}); do
		fixbnd "$folder"
	done
}

if [ "" == "$1" ]; then
	fixbnds
else
	fixbnd $1
fi